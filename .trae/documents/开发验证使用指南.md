# 开发验证使用指南

## 构建与运行
- 构建用户程序（包含相对路径与信号示例）：`cargo run -p xtask -- user-rel-exec <aarch64|riscv64|x86_64>`
- 运行内核（启用 `user-bin` 特性），在用户态执行：
  - 相对路径验证：`/bin/execrel` 或 `cd /tmp` 后执行 `hello`
  - 信号掩码验证：`/bin/sigmask`

## 系统调用矩阵
- 生成与校验：`cargo run -p xtask -- syscalls`，CI 工作流会在推送时自动校验文档同步。
- 文档位置：`/.trae/documents/Syscall 覆盖矩阵.md`

## 微基准
- 本地运行：`cargo run -p xtask -- bench`
- 基准集合：`join_path`、`copy_chunked`、`runqueue_round_robin`
- CI 工作流：`Microbench CI`，在推送或手动触发时运行并上传报表。

## 相对路径语义
- 已在 `sys_open/unlink/link/mkdir/rmdir/mknod` 与 `exec/execve` 接入 `resolve_with_cwd`，相对路径按当前 `cwd_path` 解析为绝对路径。
- 内核自测：`test_paths_relative`（`kernel_tests` 特性下执行）。

## 信号接口
- 用户库封装：`SigSet/SigAction`，`sigprocmask/sigpending/sigsuspend/sigaction`
- 内核挂接：`sigaction/sigprocmask/sigsuspend/sigpending` 四个 syscall 分支。

## 目录
- 代码参考：
  - `xtask/src/main.rs`：`syscalls/user-rel-exec/bench`
  - `user/src/bin/execrel.rs`、`user/src/bin/sigmask.rs`
  - `kernel/src/syscall.rs` 的相对路径解析与信号分支
- 工作流：`/.github/workflows/microbench.yml`、`/.github/workflows/syscall_matrix.yml`

